--- 
title: "Ames Housing: í—ˆìœ„ë§¤ë¬¼ íƒì§€ í”„ë¡œì íŠ¸"
author: 'ì¼ë‹¨ì¡1ì¡°(ì†¡ì„±í•„, í™ì£¼í˜•, í¸ì„œì˜, ì–‘í˜„ì¤€)'
format: 
  dashboard:
    theme: sandstone
    scrolling: True
    logo: project/group1_project/imagebox/nofakehouse.png
    freeze: true
--- 
```{python}
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.linear_model import LassoCV
from sklearn.model_selection import train_test_split
import plotly.express as px
plt.rcParams['font.family'] = 'Malgun Gothic'
plt.rcParams['axes.unicode_minus'] = False
pd.set_option('display.max_columns', None)

######## ì „ì²˜ë¦¬ ê³¼ì • ########
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
ames = pd.read_csv('project/group1_project/ames.csv')
df = ames.copy()

# ê·¸ë£¹ ë¶„ë¥˜ 
df_ns = df.groupby('Neighborhood')['SalePrice'].mean()

# ë¶„ìœ„ìˆ˜ ê³„ì‚°
q1 = df_ns.quantile(0.25)
q2 = df_ns.quantile(0.75)

#df['price_level'] ì´ë¼ëŠ” ì¹¼ëŸ¼ìœ¼ë¡œ ì§‘ê°’ ë³„ ë¶„ìœ„ë¡œ êµ¬ë¶„
df['price_level'] = np.select(
    [
        df['Neighborhood'].isin(df_ns[df_ns <= q1].index),
        df['Neighborhood'].isin(df_ns[(df_ns > q1) & (df_ns <= q2)].index),
        df['Neighborhood'].isin(df_ns[df_ns > q2].index)
    ],
    ['Low', 'Mid', 'High'],
    default='Unknown'  #  ë¬¸ìì—´ë¡œ í†µì¼
)

# ë²”ì£¼í˜• ì»¬ëŸ¼ë§Œ ì„ íƒ
cat_cols = df.select_dtypes(include='object').columns
# ë²”ì£¼í˜• ê²°ì¸¡ì¹˜ 'None'ìœ¼ë¡œ ëŒ€ì²´
df[cat_cols] = df[cat_cols].fillna('None')


df['amenities'] = (
    (df['PoolArea'] > 0).astype(int) +
    (df['TotalBsmtSF'] > 0).astype(int) +
    (df['GarageArea'] > 0).astype(int) + 
    (df['MiscVal'] > 0).astype(int)
)

df['TotalRooms'] = df['TotRmsAbvGrd'] + df['HalfBath'] + df['FullBath']  # ìš•ì‹¤ ì œì™¸ ë°©ìˆ˜ + ë°˜ìš•ì‹¤ + í’€ìš•ì‹¤
df['RoomDensity'] = df['TotalRooms'] / df['GrLivArea']  # ë°© ë°€ë„ (ë°©ìˆ˜ / ê±°ì‹¤ ë©´ì )
##### í—ˆìœ„ë§¤ë¬¼ íŒë‹¨ #####


## ì¡°ê±´ : ê¸°ì¤€ê°’ ìƒìœ„ 25% ì´ìƒ
df['GrLivArea_th'] = (df['GrLivArea'] / df.groupby('price_level')['GrLivArea'].transform(lambda x: x.quantile(0.75))
)

df['YearRemodAdd_th'] = (df['YearRemodAdd'] / df.groupby('price_level')['YearRemodAdd'].transform(lambda x: x.quantile(0.75))
)

df['RoomDensity_th'] = (df['RoomDensity'] / df.groupby('price_level')['RoomDensity'].transform(lambda x: x.quantile(0.75))
)

# ì§€ì—­ë“¤ ë¶„ë¦¬í•˜ëŠ” df ìƒì„±
high_df = df[df['price_level'] == 'High'].copy()
mid_df  = df[df['price_level'] == 'Mid'].copy()
low_df  = df[df['price_level'] == 'Low'].copy()

```


# {.sidebar}

## ## <span style="font-size: 14px;">ì—ì„ì¦ˆ ì¸íŠ¸ë¡œ</span> 
- ë¸”ë¼ë¸”ë¼

## <span style="font-size: 14px;">ì—°ì†í˜• > ë°•ìŠ¤í”Œë¡¯ / ë²”ì£¼í˜• > ê·¸ë˜í”„, ì¡°ê±´ë³„ ê²°ê³¼ </span>


1. 
2. 
3. 
4. 

## <span style="font-size: 14px;">íšŒê·€ëª¨ë¸</span>

1. 
2. 

## <span style="font-size: 14px;">ê²°ë¡  ë° ë³´ì™„ì </span>

1. 
2. 
3. ê²°ë¡ 
4. ë¶„ì„ì˜ ì œí•œì 

# ì¸íŠ¸ë¡œ

## Row {height=15%}

### Column {width=50%}
:::{.card}
### <span style="font-size: 30px;">ì–´ë”” ìˆë‹ˆ í—ˆìœ„ë§¤ë¬¼</span>

<img src="project/group1_project/imagebox/igotyou.png" alt="ì¡ì•˜ë‹¤ ìš”ë†ˆ" style="width: 100%;">

- ì—ì„ìŠ¤(Ames) ë„ì‹œì˜ í—ˆìœ„ë§¤ë¬¼ íƒì§€
:::

### Column {width=50%}
:::{.card}
### Ames ë„ì‹œ íŠ¹ì§•
- ìœ„ì¹˜: ë¯¸êµ­ ì•„ì´ì˜¤ì™€ì£¼ ì¤‘ë¶€, ë””ëª¨ì¸ ë¶ìª½ ì•½ 50km
- ì¸êµ¬: ì•½ 66,000ëª… (2020ë…„ ê¸°ì¤€)
- íŠ¹ì§•: 
1. ì•„ì´ì˜¤ì™€ ì£¼ë¦½ëŒ€í•™êµ ì†Œì¬ (í•™ìƒ ìˆ˜ ì•½ 30,000ëª…, ì „ì²´ ì¸êµ¬ì˜ ì•½ 45%)
2. ì•ˆì •ëœ ì£¼ê±° í™˜ê²½ê³¼ í™œë°œí•œ ì„ëŒ€ ì‹œì¥ (ì„ëŒ€ ê°€êµ¬ ë¹„ìœ¨ ì•½ 55%)
3. ì Šì€ ì¸êµ¬ ë¹„ì¤‘ ë†’ê³  êµìœ¡ ì¤‘ì‹¬ ë„ì‹œ (20~34ì„¸ ì¸êµ¬ ë¹„ì¤‘ ì•½ 40%)
:::

## Row {height=35%}

:::{.card}
### Ames ìœ„ì¹˜ ë° ì§€ì—­ ë¶„í¬
```{python}
import plotly.express as px
# ìƒ‰ìƒ ë§µí•‘

color_map = {
    'High': '#e41a1c',   # ë¹¨ê°•
    'Mid': '#ff7f00',    # ì£¼í™©
    'Low': '#4daf4a'     # ì´ˆë¡
}

# ì§€ë„ ì‹œê°í™”

fig_map = px.scatter_mapbox(
    df,
    lat='Latitude',
    lon='Longitude',
    color='price_level',
    color_discrete_map=color_map,
    hover_name='Neighborhood',
    hover_data={
        'SalePrice': True,
        'price_level': True,
        'Latitude': False,
        'Longitude': False
    },
    zoom=12,
    height=600
)

# ìŠ¤íƒ€ì¼ ë° ë ˆì´ì•„ì›ƒ ì„¤ì •
fig_map.update_layout(
    mapbox_style="open-street-map",
    mapbox_center={"lat": 42.03, "lon": -93.63},
    margin={"r": 0, "t": 0, "l": 0, "b": 0},
    legend=dict(
        title='Price Level',
        x=0.97, y=0.92,  # ì‚´ì§ ì•„ë˜ë¡œ
        xanchor='right', yanchor='top',
        bgcolor='rgba(255, 255, 255, 0.6)',  # ë°˜íˆ¬ëª…í•œ ë°°ê²½
        bordercolor='lightgray',
        borderwidth=1
    ),
    font=dict(size=14, color='black'),
)

```

- Ames ì§€ì—­ì˜ í‰ê·  ì£¼íƒê°€ê²© ê¸°ì¤€
- ìƒÂ·ì¤‘Â·í•˜ë¡œ ë¶„ë¥˜
- ê° ì ì€ ê°œë³„ ì£¼íƒì„ ì˜ë¯¸
:::

## Row {height=20%}
:::
### ì§€ì—­ë³„ ì£¼íƒ ê°€ê²© êµ¬ê°„ ë¶„ë¥˜

| ê°€ê²© êµ¬ê°„  | í‰ê·  ê°€ê²© ë²”ìœ„ (USD) | ì£¼ìš” ì§€ì—­ |
|------------|----------------------|-------------------------------|
| ğŸ”º **ê³ ê°€ ì§€ì—­ (High)** | â‰¥ 217,676 | NoRidge, NridgHt, StoneBr, Veenker, Greens, Timber |
| âš–ï¸ **ì¤‘ê°„ ì§€ì—­ (Mid)** | 136,144 ~ 217,675 | CollgCr, Mitchel, NAmes, SawyerW, OldTown, Crawfor, Edwards |
| ğŸ”» **ì €ê°€ ì§€ì—­ (Low)** | â‰¤ 136,143 | MeadowV, BrDale, IDOTRR, Landmrk, Blueste |

> - `Neighborhood`ë³„ í‰ê·  `SalePrice`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¶„ìœ„ìˆ˜(Quantile)ë¥¼ ê³„ì‚°í•˜ì—¬ ê³ ê°€/ì¤‘ê°„/ì €ê°€ë¡œ ë¶„ë¥˜í•¨  
> - ìƒìœ„ 25% ì´ìƒ: ê³ ê°€ ì§€ì—­, ì¤‘ìœ„ 50%: ì¤‘ê°„ ì§€ì—­, í•˜ìœ„ 25% ì´í•˜: ì €ê°€ ì§€ì—­

:::

## Row {height=30%}
### Column {width=5%}
:::{.card}

ğŸ”º ê³ ê°€ ì§€ì—­ (High)

- í‰ê·  ì£¼íƒ ê°€ê²©ì´ ë†’ê³  ê³ ê¸‰ ì£¼íƒ ë°€ì§‘
- ìµœì‹  ê±´ì¶•/ë¦¬ëª¨ë¸ë§, í’ˆì§ˆ ìš°ìˆ˜
- ë„“ì€ ë©´ì ê³¼ ë¶€ëŒ€ì‹œì„¤ ì™„ë¹„
- ê³ ê¸‰ ë‹¨ë…ì£¼íƒ ì¤‘ì‹¬, ì¡°ìš©í•œ í™˜ê²½
- ê±°ë˜ëŸ‰ì€ ì ì§€ë§Œ í¬ì†Œì„± ì¡´ì¬ :::

### Column {width=5%}
:::{.card}

âš–ï¸ ì¤‘ê°„ ì§€ì—­ (Mid)

- Ames í‰ê·  ìˆ˜ì¤€ ì£¼íƒ ë¶„í¬
- ë‹¤ì–‘í•œ ì£¼ê±° í˜•íƒœ(ë‹¨ë…, íƒ€ìš´í•˜ìš°ìŠ¤ ë“±)
- ì Šì€ì¸µ/ëŒ€í•™ìƒ ì„ëŒ€ ìˆ˜ìš” ì¡´ì¬
- ì¸í”„ë¼ ì–‘í˜¸, ê°€ì¡± ì„ í˜¸ ì§€ì—­
- ê±°ë˜ëŸ‰ ë§ê³  ì‹œì¥ ë‚´ í™œë°œ :::

### Column {width=5%}
:::{.card}

ğŸ”» ì €ê°€ ì§€ì—­ (Low)

- í‰ê·  ì£¼íƒ ê°€ê²© ë‚®ê³  ì¼ë¶€ ë…¸í›„
- ìœ ì§€ ê´€ë¦¬ ìƒíƒœ ì¤‘í•˜ ìˆ˜ì¤€
- ì†Œí˜• ì„ëŒ€ ì£¼íƒ ë¹„ì¤‘ ë†’ìŒ
- ì†ŒìŒ, ìƒì—…ì§€ ì¸ì ‘ ë“±ìœ¼ë¡œ ì„ í˜¸ë„ ë‚®ìŒ
- ê±°ë˜ëŸ‰ ì ê³  ì •ë³´ ë¶€ì¡± 

:::


# ìƒ˜í”Œë“¤

